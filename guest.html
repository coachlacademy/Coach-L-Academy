<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Coach L Radio â€“ Guest</title>
<style>
  html, body { margin:0; padding:0; width:100%; height:100%; font-family:'Segoe UI', sans-serif; background:#000; display:flex; justify-content:center; align-items:center; }

  /* LOGIN BOX */
  #loginBox {
    position:absolute; top:0; left:0; width:100%; height:100%;
    display:flex; justify-content:center; align-items:center; flex-direction:column;
    background:#000; color:#fff;
  }
  #loginBox input { padding:10px 15px; margin:5px 0; border-radius:8px; border:none; width:220px; font-size:1rem; }
  #loginBox button { padding:10px 20px; margin-top:10px; border:none; border-radius:20px; background:#ff3366; color:#fff; font-size:1rem; cursor:pointer; }

  /* STANDBY BOX */
  #standbyBox {
    position:absolute; top:0; left:0; width:100%; height:100%;
    display:flex; justify-content:center; align-items:center; flex-direction:column;
    background:#000; color:#fff; text-align:center; padding:20px; box-sizing:border-box;
    display:none;
  }
  #standbyBox .notice span:first-child { color:#fff; font-weight:bold; font-size:1.1rem; display:block; margin-bottom:5px; }
  #standbyBox .notice span:last-child { color:#ff0000; font-weight:bold; font-size:1.1rem; display:block; margin-bottom:20px; }

  #standbyBox button { padding:15px 30px; font-size:1.2rem; cursor:pointer; border-radius:25px; background:#ff3366; color:#fff; border:none; }

  /* JITSI IFRAME */
  #jitsiFrame { width:100%; height:100%; border:none; display:none; }
</style>
</head>
<body>

<!-- LOGIN -->
<div id="loginBox">
  <h2>Guest Login</h2>
  <input type="text" id="username" placeholder="Username">
  <input type="password" id="password" placeholder="Password">
  <button id="loginBtn">Login</button>
  <p id="loginMsg" style="color:#ff0000; margin-top:10px;"></p>
</div>

<!-- STANDBY -->
<div id="standbyBox">
  <div class="notice">
    <span>Welcome to Coach L Radio!</span>
    <span>Please click "Join Studio Call" in your browser to enter the call.</span>
  </div>
  <button id="startBtn">Join Studio Call</button>
</div>

<!-- Jitsi Iframe -->
<iframe id="jitsiFrame" allow="camera; microphone; fullscreen" allowfullscreen></iframe>

<script>
const loginBox = document.getElementById("loginBox");
const standbyBox = document.getElementById("standbyBox");
const usernameInput = document.getElementById("username");
const passwordInput = document.getElementById("password");
const loginBtn = document.getElementById("loginBtn");
const loginMsg = document.getElementById("loginMsg");

const startBtn = document.getElementById("startBtn");
const jitsiFrame = document.getElementById("jitsiFrame");

// Correct credentials
const correctUsername = "welcome";
const correctPassword = "speaker";

// LOGIN FUNCTION
loginBtn.addEventListener("click", () => {
  const user = usernameInput.value.trim();
  const pass = passwordInput.value.trim();
  if(user === correctUsername && pass === correctPassword){
    loginBox.style.display = "none";
    standbyBox.style.display = "flex";
  } else {
    loginMsg.textContent = "Incorrect username or password";
  }
});

// START JITSI CALL
startBtn.addEventListener("click", () => {
  jitsiFrame.src = "https://meet.jit.si/CoachLGuestRoom#config.startWithAudioMuted=false&config.startWithVideoMuted=false&interfaceConfig.DISABLE_VIDEO_BACKGROUND=true";
  jitsiFrame.style.display = "block";
  standbyBox.style.display = "none";

  // Monitor the iframe periodically
  const monitor = setInterval(() => {
    try {
      // If the iframe navigates outside our room (public page), reset
      const currentURL = jitsiFrame.contentWindow.location.href;
      if(!currentURL.includes("CoachLGuestRoom")) {
        jitsiFrame.src = "";
        jitsiFrame.style.display = "none";
        standbyBox.style.display = "flex";
        clearInterval(monitor);
      }
    } catch(e){
      // Cross-origin, so we can't read href; just ignore
      // Jitsi will remain in iframe until user reloads
    }
  }, 2000);
});
</script>

</body>
</html>